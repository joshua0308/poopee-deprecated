{"ast":null,"code":"import _regeneratorRuntime from \"/Users/joshuakim/poopee/frontend2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/joshuakim/poopee/frontend2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _objectSpread from \"/Users/joshuakim/poopee/frontend2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _toConsumableArray from \"/Users/joshuakim/poopee/frontend2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"/Users/joshuakim/poopee/frontend2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/joshuakim/poopee/frontend2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/joshuakim/poopee/frontend2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/joshuakim/poopee/frontend2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/joshuakim/poopee/frontend2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/joshuakim/poopee/frontend2/src/components/PageView.js\";\nimport React, { Component } from 'react';\nimport Axios from 'axios';\nimport Map from './common/Map';\nimport zoomInMarkerIcon from '../assets/zoomInMarker.png';\nimport zoomOutMarkerIcon from '../assets/zoomOutMarker.png';\nimport InfoCard from './common/InfoCardDesktop';\nimport Confetti from './common/Confetti';\nimport mapStyles from '../assets/mapStyles.json';\nvar refs = {\n  map: undefined\n};\n\nvar PageView =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(PageView, _Component);\n\n  function PageView() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, PageView);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(PageView)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      // collapse: true,\n      mapHeight: window.innerHeight,\n      isConfettiShown: false,\n      isCardShown: false,\n      zoom: null,\n      markerIcon: zoomOutMarkerIcon,\n      selectedMarker: 1,\n      user: {\n        isLoggedIn: false,\n        data: [{\n          index: 1,\n          liked: false,\n          disliked: false,\n          likedColor: '#ffffff',\n          dislikedColor: '#ffffff'\n        }]\n      },\n      restrooms: []\n    };\n\n    _this.handleMarkerClick = function (marker) {\n      var restrooms = _toConsumableArray(_this.state.restrooms);\n\n      var restroomsIndex = restrooms.indexOf(marker); // if card is hidden, show clicked card\n      // change marker icon to selected\n\n      if (!_this.state.isCardShown) {\n        // change all restrooms' selected property to false\n        for (var i = 0; i < restrooms.length; i++) {\n          restrooms[i].selected = false;\n        }\n\n        restrooms[restroomsIndex].selected = true;\n\n        _this.setState({\n          restrooms: restrooms\n        });\n\n        _this.setState({\n          selectedMarker: marker.id\n        });\n\n        _this.setState({\n          isCardShown: true\n        });\n\n        return;\n      } // if card is shown and the user clicks on the same marker, hide card\n      // change marker icon from selected to unselected\n\n\n      if (marker.id == _this.state.selectedMarker) {\n        _this.setState({\n          isCardShown: !_this.state.isCardShown\n        });\n\n        restrooms[restroomsIndex].selected = false;\n\n        _this.setState({\n          restrooms: restrooms\n        });\n\n        return;\n      } // if card is shown and the user clicks on another marker, show the clicked card\n      // change clicked marker to selected\n      // change all restrooms' selected property to false\n\n\n      for (var _i = 0; _i < restrooms.length; _i++) {\n        restrooms[_i].selected = false;\n      }\n\n      _this.setState({\n        selectedMarker: marker.id\n      });\n\n      restrooms[restroomsIndex].selected = true;\n\n      _this.setState({\n        restrooms: restrooms\n      });\n\n      console.log(marker);\n    };\n\n    _this.handleZoomChanged = function () {\n      var markerIcon = refs.map.getZoom() > 13 ? zoomInMarkerIcon : zoomOutMarkerIcon;\n\n      _this.setState({\n        zoom: refs.map.getZoom()\n      });\n\n      _this.setState({\n        markerIcon: markerIcon\n      });\n    };\n\n    _this.handleMapMounted = function (ref) {\n      refs.map = ref;\n    };\n\n    _this.handleCloseButton = function () {\n      _this.setState({\n        isCardShown: false\n      });\n\n      return;\n    };\n\n    _this.handleConfetti = function () {\n      _this.setState({\n        isConfettiShown: true\n      });\n\n      setTimeout(function () {\n        _this.setState({\n          isConfettiShown: false\n        });\n      }, 3500);\n      return;\n    };\n\n    _this.handleLikeButtonClicked = function () {\n      // check user login status\n      if (!_this.state.user.isLoggedIn) {\n        console.log('User not logged in');\n      }\n\n      var restrooms = _toConsumableArray(_this.state.restrooms);\n\n      var index = _this.state.selectedMarker;\n\n      var user = _objectSpread({}, _this.state.user); // if user disliked the bathroom, undo dislike\n\n\n      if (!_this.state.user.data[0].liked && _this.state.user.data[0].disliked) {\n        restrooms[index].dislike--;\n        user.data[0].disliked = false;\n        user.data[0].dislikedColor = '#FFFFFF';\n\n        _this.setState({\n          restrooms: restrooms\n        });\n\n        _this.setState({\n          user: user\n        });\n\n        return;\n      } // check if user already liked\n      // if liked, undo like\n\n\n      if (_this.state.user.data[0].liked) {\n        console.log('Already liked. Unliking.');\n        restrooms[index].like--;\n        user.data[0].liked = false;\n        user.data[0].likedColor = '#FFFFFF';\n\n        _this.setState({\n          restrooms: restrooms\n        });\n\n        _this.setState({\n          user: user\n        });\n\n        return;\n      } // update like #\n\n\n      restrooms[index].like++;\n\n      _this.setState({\n        restrooms: restrooms\n      });\n\n      console.log('Liked'); // update user like status\n\n      user.data[0].liked = true;\n      user.data[0].likedColor = '#ffef9e';\n\n      _this.setState({\n        user: user\n      }); // show confetti\n\n\n      _this.handleConfetti();\n    };\n\n    _this.handleDislikeButtonClicked = function () {\n      // check user login status\n      if (!_this.state.user.isLoggedIn) {\n        console.log('User not logged in');\n      }\n\n      var restrooms = _toConsumableArray(_this.state.restrooms);\n\n      var index = _this.state.selectedMarker;\n\n      var user = _objectSpread({}, _this.state.user); // if user liked the bathroom, undo like\n\n\n      if (!_this.state.user.data[0].disliked && _this.state.user.data[0].liked) {\n        restrooms[index].like--;\n        user.data[0].liked = false;\n        user.data[0].likedColor = '#FFFFFF';\n\n        _this.setState({\n          restrooms: restrooms\n        });\n\n        _this.setState({\n          user: user\n        });\n\n        return;\n      } // check if user already disliked\n      // if disliked, undo\n\n\n      if (_this.state.user.data[0].disliked) {\n        console.log('Already disliked.');\n        restrooms[index].dislike--;\n        user.data[0].disliked = false;\n        user.data[0].dislikedColor = '#FFFFFF';\n\n        _this.setState({\n          restrooms: restrooms\n        });\n\n        _this.setState({\n          user: user\n        });\n\n        return;\n      } // update like #\n\n\n      restrooms[index].dislike++;\n\n      _this.setState({\n        restrooms: restrooms\n      });\n\n      console.log('Disliked'); // update user like status\n\n      user.data[0].disliked = true;\n      user.data[0].dislikedColor = '#ff8a68';\n\n      _this.setState({\n        user: user\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(PageView, [{\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee() {\n        var _ref, restrooms;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return Axios.get('https://mysterious-earth-50755.herokuapp.com/api/restrooms');\n\n              case 2:\n                _ref = _context.sent;\n                restrooms = _ref.data;\n                this.setState({\n                  restrooms: restrooms\n                });\n\n              case 5:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 208\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"MapContainer\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 209\n        },\n        __self: this\n      }, React.createElement(Map, {\n        defaultOptions: {\n          disableDefaultUI: true,\n          gestureHandling: 'greedy',\n          styles: mapStyles\n        },\n        onMapMounted: this.handleMapMounted,\n        defaultZoom: 13,\n        defaultCenter: {\n          lat: 40.736362,\n          lng: -73.998695\n        },\n        googleMapURL: \"https://maps.googleapis.com/maps/api/js?key=AIzaSyA1qg3OHSHEjNHsL6hg6A-1NX-5lsCFquw&v=3.exp&libraries=geometry,drawing,places\",\n        loadingElement: React.createElement(\"div\", {\n          style: {\n            height: \"100%\"\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 220\n          },\n          __self: this\n        }),\n        containerElement: React.createElement(\"div\", {\n          style: {\n            height: \"\".concat(this.state.mapHeight, \"px\")\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 222\n          },\n          __self: this\n        }),\n        mapElement: React.createElement(\"div\", {\n          style: {\n            height: \"100%\"\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 224\n          },\n          __self: this\n        }),\n        onZoomChanged: this.handleZoomChanged,\n        restrooms: this.state.restrooms,\n        markerIcon: this.state.markerIcon,\n        onMarkerClick: this.handleMarkerClick,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 210\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"CardContainer\",\n        style: {\n          position: 'absolute',\n          top: '0px',\n          zIndex: 1\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 231\n        },\n        __self: this\n      }, this.state.isCardShown && React.createElement(InfoCard, {\n        className: InfoCard,\n        restroom: this.state.restrooms[this.state.selectedMarker],\n        index: this.state.selectedMarker,\n        onLikeButtonClicked: this.handleLikeButtonClicked,\n        onDislikeButtonClicked: this.handleDislikeButtonClicked,\n        user: this.state.user,\n        onCloseButton: this.handleCloseButton,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 236\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 247\n        },\n        __self: this\n      }, this.state.isConfettiShown && React.createElement(Confetti, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 247\n        },\n        __self: this\n      })));\n    }\n  }]);\n\n  return PageView;\n}(Component);\n\nexport default PageView;","map":{"version":3,"sources":["/Users/joshuakim/poopee/frontend2/src/components/PageView.js"],"names":["React","Component","Axios","Map","zoomInMarkerIcon","zoomOutMarkerIcon","InfoCard","Confetti","mapStyles","refs","map","undefined","PageView","state","mapHeight","window","innerHeight","isConfettiShown","isCardShown","zoom","markerIcon","selectedMarker","user","isLoggedIn","data","index","liked","disliked","likedColor","dislikedColor","restrooms","handleMarkerClick","marker","restroomsIndex","indexOf","i","length","selected","setState","id","console","log","handleZoomChanged","getZoom","handleMapMounted","ref","handleCloseButton","handleConfetti","setTimeout","handleLikeButtonClicked","dislike","like","handleDislikeButtonClicked","get","disableDefaultUI","gestureHandling","styles","lat","lng","height","position","top","zIndex"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport Axios from 'axios';\nimport Map from './common/Map';\nimport zoomInMarkerIcon from '../assets/zoomInMarker.png';\nimport zoomOutMarkerIcon from '../assets/zoomOutMarker.png';\nimport InfoCard from './common/InfoCardDesktop';\nimport Confetti from './common/Confetti';\nimport mapStyles from '../assets/mapStyles.json';\n\nvar refs = {\n  map: undefined\n};\n\nclass PageView extends Component {\n  state = {\n    // collapse: true,\n    mapHeight: window.innerHeight,\n    isConfettiShown: false,\n    isCardShown: false,\n    zoom: null,\n    markerIcon: zoomOutMarkerIcon,\n    selectedMarker: 1,\n    user: {\n      isLoggedIn: false,\n      data: [\n        {\n          index: 1,\n          liked: false,\n          disliked: false,\n          likedColor: '#ffffff',\n          dislikedColor: '#ffffff'\n        }\n      ]\n    },\n    restrooms: []\n  };\n\n  async componentDidMount() {\n    // get restrooms data\n    // get user data\n    const { data: restrooms } = await Axios.get(\n      'https://mysterious-earth-50755.herokuapp.com/api/restrooms'\n    );\n    this.setState({ restrooms });\n  }\n\n  handleMarkerClick = marker => {\n    let restrooms = [...this.state.restrooms];\n    let restroomsIndex = restrooms.indexOf(marker);\n\n    // if card is hidden, show clicked card\n    // change marker icon to selected\n    if (!this.state.isCardShown) {\n      // change all restrooms' selected property to false\n      for (let i = 0; i < restrooms.length; i++) {\n        restrooms[i].selected = false;\n      }\n      restrooms[restroomsIndex].selected = true;\n      this.setState({ restrooms });\n      this.setState({ selectedMarker: marker.id });\n      this.setState({ isCardShown: true });\n      return;\n    }\n\n    // if card is shown and the user clicks on the same marker, hide card\n    // change marker icon from selected to unselected\n    if (marker.id == this.state.selectedMarker) {\n      this.setState({ isCardShown: !this.state.isCardShown });\n\n      restrooms[restroomsIndex].selected = false;\n      this.setState({ restrooms });\n      return;\n    }\n\n    // if card is shown and the user clicks on another marker, show the clicked card\n    // change clicked marker to selected\n    // change all restrooms' selected property to false\n    for (let i = 0; i < restrooms.length; i++) {\n      restrooms[i].selected = false;\n    }\n    this.setState({ selectedMarker: marker.id });\n    restrooms[restroomsIndex].selected = true;\n    this.setState({ restrooms });\n\n    console.log(marker);\n  };\n\n  // change the marker size when user zooms in or out\n  // access zoom level using the map reference\n  handleZoomChanged = () => {\n    let markerIcon =\n      refs.map.getZoom() > 13 ? zoomInMarkerIcon : zoomOutMarkerIcon;\n    this.setState({ zoom: refs.map.getZoom() });\n    this.setState({ markerIcon });\n  };\n\n  handleMapMounted = ref => {\n    refs.map = ref;\n  };\n\n  handleCloseButton = () => {\n    this.setState({ isCardShown: false });\n    return;\n  };\n\n  // toggle confetti bc when confetti is run: true, user can't click on anything else. so we have to turn it off after confetti is finished.\n  handleConfetti = () => {\n    this.setState({ isConfettiShown: true });\n    setTimeout(() => {\n      this.setState({ isConfettiShown: false });\n    }, 3500);\n    return;\n  };\n\n  handleLikeButtonClicked = () => {\n    // check user login status\n    if (!this.state.user.isLoggedIn) {\n      console.log('User not logged in');\n    }\n\n    let restrooms = [...this.state.restrooms];\n    let index = this.state.selectedMarker;\n    let user = { ...this.state.user };\n\n    // if user disliked the bathroom, undo dislike\n    if (!this.state.user.data[0].liked && this.state.user.data[0].disliked) {\n      restrooms[index].dislike--;\n      user.data[0].disliked = false;\n      user.data[0].dislikedColor = '#FFFFFF';\n      this.setState({ restrooms });\n      this.setState({ user });\n      return;\n    }\n\n    // check if user already liked\n    // if liked, undo like\n    if (this.state.user.data[0].liked) {\n      console.log('Already liked. Unliking.');\n\n      restrooms[index].like--;\n      user.data[0].liked = false;\n      user.data[0].likedColor = '#FFFFFF';\n      this.setState({ restrooms });\n      this.setState({ user });\n      return;\n    }\n\n    // update like #\n    restrooms[index].like++;\n    this.setState({ restrooms });\n    console.log('Liked');\n\n    // update user like status\n    user.data[0].liked = true;\n    user.data[0].likedColor = '#ffef9e';\n    this.setState({ user });\n\n    // show confetti\n    this.handleConfetti();\n  };\n\n  handleDislikeButtonClicked = () => {\n    // check user login status\n    if (!this.state.user.isLoggedIn) {\n      console.log('User not logged in');\n    }\n\n    let restrooms = [...this.state.restrooms];\n    let index = this.state.selectedMarker;\n    let user = { ...this.state.user };\n\n    // if user liked the bathroom, undo like\n    if (!this.state.user.data[0].disliked && this.state.user.data[0].liked) {\n      restrooms[index].like--;\n      user.data[0].liked = false;\n      user.data[0].likedColor = '#FFFFFF';\n      this.setState({ restrooms });\n      this.setState({ user });\n      return;\n    }\n\n    // check if user already disliked\n    // if disliked, undo\n    if (this.state.user.data[0].disliked) {\n      console.log('Already disliked.');\n\n      restrooms[index].dislike--;\n      user.data[0].disliked = false;\n      user.data[0].dislikedColor = '#FFFFFF';\n      this.setState({ restrooms });\n      this.setState({ user });\n      return;\n    }\n\n    // update like #\n    restrooms[index].dislike++;\n    this.setState({ restrooms });\n    console.log('Disliked');\n\n    // update user like status\n    user.data[0].disliked = true;\n    user.data[0].dislikedColor = '#ff8a68';\n    this.setState({ user });\n  };\n\n  render() {\n    return (\n      <React.Fragment>\n        <div className='MapContainer'>\n          <Map\n            defaultOptions={{\n              disableDefaultUI: true,\n              gestureHandling: 'greedy',\n              styles: mapStyles\n            }}\n            onMapMounted={this.handleMapMounted}\n            defaultZoom={13}\n            defaultCenter={{ lat: 40.736362, lng: -73.998695 }}\n            googleMapURL='https://maps.googleapis.com/maps/api/js?key=AIzaSyA1qg3OHSHEjNHsL6hg6A-1NX-5lsCFquw&v=3.exp&libraries=geometry,drawing,places'\n            loadingElement={<div style={{ height: `100%` }} />}\n            containerElement={\n              <div style={{ height: `${this.state.mapHeight}px` }} />\n            }\n            mapElement={<div style={{ height: `100%` }} />}\n            onZoomChanged={this.handleZoomChanged}\n            restrooms={this.state.restrooms}\n            markerIcon={this.state.markerIcon}\n            onMarkerClick={this.handleMarkerClick}\n          />\n        </div>\n        <div\n          className='CardContainer'\n          style={{ position: 'absolute', top: '0px', zIndex: 1 }}\n        >\n          {this.state.isCardShown && (\n            <InfoCard\n              className={InfoCard}\n              restroom={this.state.restrooms[this.state.selectedMarker]}\n              index={this.state.selectedMarker}\n              onLikeButtonClicked={this.handleLikeButtonClicked}\n              onDislikeButtonClicked={this.handleDislikeButtonClicked}\n              user={this.state.user}\n              onCloseButton={this.handleCloseButton}\n            />\n          )}\n        </div>\n        <div>{this.state.isConfettiShown && <Confetti />}</div>\n      </React.Fragment>\n    );\n  }\n}\n\nexport default PageView;\n"]},"metadata":{},"sourceType":"module"}